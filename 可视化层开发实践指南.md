# LifeOS Command Deck Implementation Guide

本指南指导如何构建一个 **Strategic Visualization Interface** (战略可视化界面，即 Commander Deck)。

## 1. 技术栈建议 (Monitoring Stack)

- **Frontend**: Next.js (React) + ShadcnUI.
- **Graph Viz**: `react-force-graph` (显示 Active Graph).
- **Backend**: Python FastAPI (The Gateway).
  - Entry Point: `gateway/api_server.py`.

## 2. 核心视图实现

### 2.1 资源视图 (The Library View - Knowledge Graph)

**Data Source**: `GET /graph/active` (Ref: `gateway/api_server.py`)
**Component**: `react-force-graph`.
- **Node Colors**:
  - Blue: `Idea`
  - Red: `Action/SOP` (Active Intelligence)
  - Green: `Asset`
  - Grey: `Context` (Location/Time)

### 2.2 执行视图 (The Pipeline View)

**Data Source**: `GET /context/current` & `GET /sop/active_tasks`
- **Columns**: `Listening (Context)`, `Analyzing (Brain)`, `Executing (SOP Actions)`.
- **Real-time**: 使用 WebSocket `/ws/status` (Planned) 订阅 Agent 思考过程。

### 2.3 仪表盘视图 (The Dashboard)

**Data Source**: Real-time Context API (`GET /ingest/context` results).
- **Widgets**:
  - **Context Nodes**: 把 `ContextPayload` 可视化为动态气泡。
  - **Trigger Log**: 显示最近被激活的 SOP 列表。

### 2.4 Control Plane

在界面实现手动触发和上传功能：
- **Upload SOP**: POST `/sop/upload` (Interface for adding new tactics).
- **Manual Trigger**: POST `/ingest/context` (Simulate triggers for testing).


## 3. 数据源聚合

- **PostgreSQL**: 读取历史 Insight 和 Timeline。
- **Redis Pub/Sub**: 订阅实时 Agent 状态流 (用于 WebSocket 推送)。

## 4. 关键指标 (UX Metrics)

- **Latency**: Agent 状态更新必须 < 200ms (WebSocket)。
- **Clarity**: 即使有 50 个并发 Agent，也能通过折叠/聚合清晰展示。
