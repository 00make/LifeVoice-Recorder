### 手机端录音
应用产品定义文档（PRD）

#### 1. 产品名称

**LifeVoice Recorder**（生活语音记录器）  

- 副标题：你的24小时个人AI语音日志助手  
- 定位：一款专注于全天候语音采集、分段记录与安全上传的Android应用，专为个人AI助手系统设计。端侧“轻量过滤”，云侧（个人高性能PC）“深度精修”。

#### 2. 产品概述

LifeVoice Recorder 是一款运行在Android手机上的前台服务应用，旨在实现**近似24小时的语音数据采集**（实际为语音活动触发式采集，避免无效静音录制）。核心目标是捕捉用户日常生活中的对话、独白、环境声等语音片段，进行智能分段、轻量处理后安全上传到用户自建服务器（高性能PC，RTX 5090），供后续Whisper Large、Pyannote、LLM等模型进行高质量转录、说话人分离、总结，形成个人知识库和AI助手素材。

**核心理念**：  

- “轻端重云、异步精修”：手机端只做过滤与压缩（省电、省流量），主机端做理解与生成（高精度）。  
- 不是“一直录音”，而是**VAD驱动的智能分段录音**，大幅降低电池与存储负担。  
- 完全本地化隐私：所有数据默认本地缓存，上传需用户主动确认或自动加密。

#### 3. 目标用户

- **主要用户**：科技爱好者、个人知识管理极客、需要记录生活对话/灵感/会议的个体（如你自己）。  
- **用户画像**：拥有高通骁龙高端手机（支持NPU加速）+ 自建高性能PC服务器；注重隐私，不愿使用云服务（如Google/Siri）；追求自动化个人AI助手。  
- **用户痛点**：手动录音遗漏重要内容；现有录音App无法智能分段；需要与强大后端AI联动。

#### 4. 核心功能

##### 4.1 主功能模块

1. **智能语音采集（核心）**  
   - 使用前台服务（Foreground Service）+ 常驻通知，实现近24小时麦克风访问。  
   - 集成VAD（语音活动检测），仅在检测到人声时开始录音，静音自动暂停/丢弃。  
   - 分段规则：单段最长5-10分钟（避免文件过大），自然停顿>5秒自动结束一段。

2. **端侧轻量处理**  
   - 轻度降噪（RNNoise或类似轻量模型）。  
   - 音频压缩（Opus编码，降低文件大小50-80%）。  
   - **实时转录显示**：使用sherpa-onnx QNN模型的SenseVoice，提供低延迟实时字幕显示，支持中英日韩粤多语言识别。
   - 转录结果本地缓存，可选择是否保存文本内容。  
   - 元数据标记：时间戳、位置（可选）、简单音频标签（人声/噪音）。

3. **本地存储与管理**  
   - 分段音频文件本地加密存储（AES-256）。  
   - 本地列表查看：按时间线浏览已录片段，支持手动删除/标记重要段落。

4. **安全上传**  
   - 自动/手动上传到用户自建服务器（支持HTTPS/WebDAV/FTP）。  
   - 上传前压缩+加密，传输过程端到端加密。  

5. **用户控制中心**  
   - 一键暂停/恢复采集。  

##### 4.2 辅助功能（MVP后迭代）

- 关键词唤醒（Porcupine）：听到自定义词（如"记一下"）强制开始一段高优先级录音。  
- 实时转录管理：查看/编辑端侧转录结果，标记重要片段。  
- 简单统计：今日录音时长、转录字数、上传量。  
- 与服务器反馈联动：服务器处理完成后推送通知（如"今日日志已总结"）。

#### 5. 用户场景

- **日常使用**：手机放在口袋/桌面，全天自动捕捉对话并实时显示转录文字。用户可随时查看当前对话内容，晚上回家连Wi-Fi自动上传原始音频和转录文本。  
- **高价值时刻**：工作会议、学习自言自语、旅行记录环境声，实时转录帮助用户确认重要内容是否被正确记录。  
- **与AI助手结合**：上传后，服务器基于端侧转录结果进行深度处理，生成结构化日记（如"今天和朋友讨论了XX项目"），供个人AI查询。

#### 6. 系统架构（端侧 vs. 主机侧）

遵循“轻端重云”原则，能力分配如下表：

| 功能模块                  | 部署位置       | 推荐模型/工具                        | 理由                                                                 |
|---------------------------|----------------|-------------------------------------|----------------------------------------------------------------------|
| VAD (语音活动检测)        | 端侧 (核心)    | Silero VAD / WebRTC VAD / android-vad | 必须端侧实时检测，切除静音，减少90%无效数据                          |
| Audio Tagging (音频分类)  | 端侧 (可选)    | YAMNet Lite                         | 过滤纯噪音段，直接丢弃                                               |
| Keyword Spotting          | 端侧           | Porcupine / OpenWakeWord            | 标记重要时刻，低功耗                                                 |
| Speech Denoising (降噪)   | 端侧 (轻量)    | RNNoise                             | 轻度清理，保证清晰；重度留服务器                                     |
| Streaming ASR (实时转录)  | 端侧 (核心功能)| sherpa-onnx QNN SenseVoice          | 本地实时转录显示，低延迟字幕，支持多语言识别，转录结果可选择保存     |
| Non-streaming ASR         | 主机侧         | Whisper Large-V3                    | 高精度转录，利用RTX 5090显存                                         |
| Speaker Diarization/ID    | 主机侧         | Pyannote.audio                      | 区分说话人，构建对话形式日志                                         |
| Language ID               | 主机侧         | Whisper 自带                        | 支持中英日韩粤混合                                                   |
| LLM Summarization         | 主机侧         | Qwen-2.5-32B / Llama3               | 生成结构化日记、知识点提取                                           |

#### 7. 非功能需求

- **电池与性能**：目标全天耗电<15%（VAD驱动下）。使用低功耗音频API，避免常亮屏幕。  

- **兼容性**：Android 10+，优先高通骁龙SM8350+（NPU加速）。  
- **存储**：每日语音数据预计<500MB（压缩后）。  
- **限制应对**：Android 15+对前台服务有限制（dataSync类型每天最多6小时），通过“media”或“microphone”类型规避，或提示用户手动重启。

#### 8. MVP开发路线图

1. **Phase 1（1-2个月）**：核心采集+ VAD分段 + 本地存储 + 手动上传。  
2. **Phase 2**：自动上传 + 轻量降噪。  
3. **Phase 3**：优化端侧实时转录 + 关键词唤醒 + 转录结果管理。  
4. **Phase 4**：服务器端对接 + 反馈通知。

#### 9. 风险与缓解

- **电池消耗**：实测优化VAD阈值；提供“低功耗模式”（仅关键词触发）。  
- **隐私顾虑**：UI显著提示“所有数据本地加密，仅您可见”。  
- **系统限制**：测试多品牌手机（小米/三星杀后台问题），提供白名单引导。  
- **法律合规**：增加“录音前通知”选项（如弹窗提醒周围人）。
